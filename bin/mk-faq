#! /bin/sh

for faqfile in "$@"; do
    anchor=`basename $faqfile .txt | cut -f3 -d- | tr '[:lower:]' '[:upper:]'`
    count=0

    cat $faqfile \
	| perl -pe 'BEGIN { $count = 0} s/^(\* *)(?{ $count++ })/$1\|'${anchor}'${count}\|/' \
	| pandoc -t html --no-highlight \
	| sed -E -e 's/<([^<>]*)>\|([A-Z]*[0-9]*)\|/<\1 id="\2">/'
done
